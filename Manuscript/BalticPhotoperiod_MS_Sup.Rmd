---
title: "Changing diel growth symmetries and light-capture in PhycoCyanin and PhycoErythrin-rich picocyanobacteria, across photic regimes and growth phases"
author:
- Sylwia Śliwińska-Wilczewska:
    institute:
    - MTA
    - UG
    email: ssliwinskawilczews@mta.ca
- Marta Konik:
    institute:
    - VU
    - IOPAN
    email: mk@iopan.gda.pl
- Mireille Savoie:
    institute: MTA
    email: msavoie@mta.ca
- Naaman Omar:
    institute: MTA
    email: nomar@mta.ca
- Douglas A. Campbell:
    institute: MTA
    email: dcampbel@mta.ca
    correspondence: true
institute:
- MTA: Department of Biology, Mount Allison University, 53 York St., Sackville NB,
    Canada, E4L 1C9
- UG: "Institute of Oceanography, University of Gdansk, 46 Pilsudskiego St, P81-378,
    Gdynia, Poland"
- VU: Department of Geography, University of Victoria, Victoria, BC V8P 5C2, Canada
- IOPAN: "Institute of Oceanology, Polish Academy of Sciences, 81-712 Sopot, Poland"
output:
  bookdown::word_document2:
    reference_docx: Template.docx
    code-folding: show
    keep_md: yes
    fig.caption: yes
    toc: FALSE
    pandoc_args:
    - "--lua-filter=scholarly-metadata.lua"
    - "--lua-filter=author-info-blocks.lua"
  html_document:
    df_print: paged
  word_document:
    reference_docx: Template.docx
    code-folding: show
    keep_md: yes
    fig.caption: yes
    toc: FALSE
    pandoc_args:
    - "--lua-filter=scholarly-metadata.lua"
    - "--lua-filter=author-info-blocks.lua"
bibliography:
- BalticPhotoperiod.bib
- packages.bib
csl: "plos-one.csl"
---

```{r, import libraries, include = FALSE}
library(tidyverse)
library(glue)
library(googlesheets4)
googlesheets4:: gs4_deauth()
#library(kableExtra)
library(flextable)
library(officer)
library(knitr)
library(readxl)
library(stringr)
library(rmarkdown)
library(gdtools)
#library(trackdown)
options(knitr.table.format = "word_document2", knitr.kable.NA = '') 
```

```{r, save package citations, include = FALSE}
knitr:: write_bib(c("tidyverse", "glue", "googlesheets4", "kableExtra"), "packages.bib")
```

```{r defining filepaths, include = FALSE}
FiguresFP <- file.path("..", "Output", "Figures")
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Supplementary material {.unnumbered}

```{r GrowthCurveOD680, fig.cap = GrowthCurveOD680_cap, fig.height = 8, fig.width = 6, echo = FALSE}
GrowthCurveOD680_cap<- glue("Example of representative growth curves (tracked as OD~680~) of two PhycoCyanin(PC)-rich cultures (light green line; 056, dark green line; 077) and two PhycoErythrin(PE)-rich cultures (light red line; 048, dark red line; 127) (Culture Collection of Baltic Algae) of *Synechococcus* sp. grown at 30, 90, 180, 300, or 900 peak PAR µmol photons m^−2^s^−1^; and photoperiods of 8, 12, 16, or 24 h. The vertical lines represent the time when the cultures reached their maximum absolute hourly growth (tMaxAG), taken as an index of transition from exponential to pre-stationary growth phases. The orange area represents the photoperiods, with peak PAR x 1/1000 to scale to the Y axis.", .sep = " ")
knitr::include_graphics(file.path(FiguresFP, "SFig_GrowthCurve_OD680.png"))
```

```{r GrowthCurveOD720, fig.cap = GrowthCurveOD720_cap, fig.height = 8, fig.width = 6, echo = FALSE}
GrowthCurveOD720_cap<- glue("Example of representative growth curves (tracked as OD~720~) of two PhycoCyanin(PC)-rich cultures (light green line; 056, dark green line; 077) and two PhycoErythrin(PE)-rich cultures (light red line; 048, dark red line; 127) (Culture Collection of Baltic Algae) of *Synechococcus* sp. grown at 30, 90, 180, 300, or 900 peak PAR µmol photons m^−2^s^−1^; and photoperiods of 8, 12, 16, or 24 h. The vertical lines represent the time when the cultures reached their maximum absolute hourly growth (tMaxAG), taken as an index of transition from exponential to pre-stationary growth phases. The orange area represents the photoperiods, with peak PAR x 1/1000 to scale to the Y axis.", .sep = " ")
knitr::include_graphics(file.path(FiguresFP, "SFig_GrowthCurve_OD720.png"))
```


```{r GrowthCurveDeltaOD, fig.cap = GrowthCurveDeltaOD_cap, fig.height = 8, fig.width = 6, echo = FALSE}
GrowthCurveDeltaOD_cap<- glue("Example of representative growth curves (tracked as Delta OD) of two PhycoCyanin(PC)-rich cultures (light green line; 056, dark green line; 077) and two PhycoErythrin(PE)-rich cultures (light red line; 048, dark red line; 127) (Culture Collection of Baltic Algae) of *Synechococcus* sp. grown at 30, 90, 180, 300, or 900 peak PAR µmol photons m^−2^s^−1^; and photoperiods of 8, 12, 16, or 24 h. The vertical lines represent the time when the cultures reached their maximum absolute hourly growth (tMaxAG), taken as an index of transition from exponential to pre-stationary growth phases. The orange area represents the photoperiods, with peak PAR x 1/1000 to scale to the Y axis.", .sep = " ")
knitr::include_graphics(file.path(FiguresFP, "SFig_GrowthCurve_DeltaOD.png"))
```


```{r GrowthRateLight, fig.cap = GrowthRateLight_cap, fig.height = 8, fig.width = 6, echo = FALSE}
GrowthRateLight_cap<- glue("Chlorophyll specific exponential growth rates, estimated from logistic fits of chlorophyll proxy OD~680~-OD~720~ vs. elapsed time, for two PhycoCyanin(PC)-rich cultures (056, 077) and two PhycoErythrin(PE)-rich cultures (048, 127) (Culture Collection of Baltic Algae) of *Synechococcus* sp. grown at 30 (dark gray), 90 (light gray), 180 (purple), 300 (red), 600 (orange), or 900 (yellow) peak PAR µmol photons m^−2^s^−1^; and photoperiods of 8 (square), 12 (circle), 16 (triangle), or 24 (diamond) h. Growth rates (+/- SE from logistic model; SE falls within symbol sizes) are plotted vs. cumulative diel µmol photons m^−2^d^−1^. Solid blue line shows fit of the pooled data with a three parameter model (Harrison and Platt, 1986). We also fit the same model for chlorophyll specific exponential growth rate across 30 (dark gray), 90 (light gray), 180 (purple), 300 (red), 600 together with 900 (orange) peak PAR µmol photons m^−2^s^−1^, only when they were significantly different (ANOVA, *p* < 0.05) from the fit of pooled data.", .sep = " ")
knitr::include_graphics(file.path(FiguresFP,"SFig_GrowthRate_Light.png"))
```


```{r AccLen, fig.cap = AccLen_cap, fig.height = 8, fig.width = 6, echo = FALSE}
AccLen_cap<- glue("Hours of photoperiod to reach maximum hourly growth increment (AccLen), for two PhycoCyanin(PC)-rich cultures (056, 077) and two PhycoErythrin(PE)-rich cultures (048, 127) (Culture Collection of Baltic Algae) of *Synechococcus* sp. grown at 30, 90, 180, 300, or 900 peak PAR µmol photons m^−2^s^−1^; and photoperiods of 8, 12, or 16 h. The diagonal dashed lines indicate the time (h) to reach the maximum light during the day. Figure represents all data (small symbols) and means (big symbols) for n = 0-5 days from exponential phase, or from pre-stationary growth phase.", .sep = " ")
knitr::include_graphics(file.path(FiguresFP,"SFig_AccLen.png"))
```



```{r TDG, fig.cap = TDG_cap, fig.height = 6, fig.width = 8, echo = FALSE}
TDG_cap<- glue("Changes of TDG (tracked as daily change in OD~680~ increment) of two PhycoCyanin(PC)-rich cultures (056, 077) and two PhycoErythrin(PE)-rich cultures (048, 127) (Culture Collection of Baltic Algae) of *Synechococcus* sp. grown at 30, 90, 180, 300, or 900 peak PAR µmol photons m^−2^s^−1^; and photoperiods of 8, 12, or 16 h. The vertical lines represent the time when the strains reached their maximum absolute hourly growth (tMaxAG).", .sep = " ")
knitr::include_graphics(file.path(FiguresFP,"SFig_TDG.png"))
```


```{r PhycoChlaRatio, fig.cap = PhycoChlaRatio_cap, fig.height = 6, fig.width = 8, echo = FALSE}
PhycoChlaRatio_cap<- glue("Changes of total Phyco/Chl *a* ratio of two PhycoCyanin(PC)-rich cultures (056, 077) and two PhycoErythrin(PE)-rich cultures (048, 127) (Culture Collection of Baltic Algae) of *Synechococcus* sp. grown at 30, 90, 180, 300, 600, or 900 peak PAR µmol photons m^−2^s^−1^; and photoperiods of 8, 12, 16, or 24 h. Figure represents all data (small symbols) and means (big symbols) from exponential phase, or from pre-stationary growth phase. Blue solid line shows single phase exponential decay fit of pooled data; fit parameters are presented. Different lowercase letters indicate significant differences between the fit models for strains for a given phase of growth (ANOVA; *p* < 0.05).", .sep = " ")
knitr::include_graphics(file.path(FiguresFP,"SFig_PhycoChlaRatio.png"))
```


```{r Sigma445, fig.cap = Sigma445_cap, fig.height = 8, fig.width = 6, echo = FALSE}
Sigma445_cap<- glue("Effective absorption cross section of PSII (\u03C3~PSII~'; nm^2^ quanta^-1^) measured under diel peak PAR growth light under Ex445 nm (blue) excitation in two PhycoCyanin(PC)-rich cultures (056, 077) and two PhycoErythrin(PE)-rich cultures (048, 127) (Culture Collection of Baltic Algae) of *Synechococcus* sp. grown at 30, 90, 180, 300, 600, or 900 peak PAR µmol photons m^−2^s^−1^; and photoperiods of 8, 12, 16, or 24 h. Figure represents all data (small symbols) and means (big symbols) from exponential phase, or from pre-stationary growth phase. Blue solid line shows linear model fit.", .sep = " ")
knitr::include_graphics(file.path(FiguresFP,"SFig_Sigma445.png"))
```


```{r SigmaPig445, fig.cap = SigmaPig445_cap, fig.height = 8, fig.width = 6, echo = FALSE}
SigmaPig445_cap<- glue("Changes of effective absorption cross section of PSII (\u03C3~PSII~'; nm^2^ quanta^-1^) measured under diel peak PAR growth light under Ex445 nm (blue) excitation in relation to the total Phyco/Chl *a* ratio of two PhycoCyanin(PC)-rich cultures (Culture Collection of Baltic Algae; 056, 077) and two PhycoErythrin(PE)-rich cultures (Culture Collection of Baltic Algae; 048, 127) of *Synechococcus* sp. grown at 30, 90, 180, 300, 600, or 900 peak PAR µmol photons m^−2^s^−1^; and photoperiods of 8, 12, 16, or 24 h. Figure represents all data (small symbols) and means (big symbols) from exponential phase, or from pre-stationary growth phase. Blue solid line shows linear model fit.", .sep = " ")
knitr::include_graphics(file.path(FiguresFP,"SFig_SigmaPig445.png"))
```


```{r locally stored metadata from rds, echo = FALSE}
# https://davidgohel.github.io/flextable/reference/index.html

# BalticPhotoperiod_Tab_PigmentsCorrelation.Rds
# BalticPhotoperiod_Tab_GrowthCorrelation.Rds

# BalticPhotoperiod_Anova_GrowthRate.Rds
# BalticPhotoperiod_Anova_GrowthRate_Model_Light.Rds
# BalticPhotoperiod_Anova_GrowthRate_Model_Photoperiod.Rds

# BalticPhotoperiod_Anova_GS.Rds
# BalticPhotoperiod_Anova_GS_Model.Rds
# BalticPhotoperiod_Anova_GS_Param.Rds 
```


```{r echo = FALSE}
GrowthCorrelation <- readRDS(file = file.path("..", "Output", "TablesRds", "BalticPhotoperiod_Tab_GrowthCorrelation.Rds"))
GrowthCorrelation<-GrowthCorrelation

myft <- flextable(GrowthCorrelation)
myft <- set_caption(myft, caption = "Linear regression, coefficient of determination (R square), correlation coefficients (R), and p-value used to calculate the number of studied picocyanobacteria cells (N/mL) in cultures based on optical density (OD) measurements.")
myft <- colformat_double(x = myft, big.mark = ",", digits = 3, na_str = "N/A")
myft <- fontsize(myft, size = 12, part = "header")
myft <- fontsize(myft, size = 10, part = "body")
myft <- autofit(myft)
myft

rm(GrowthCorrelation)
```

```{r echo = FALSE}
PigmentsCorrelation <- readRDS(file = file.path("..", "Output", "TablesRds", "BalticPhotoperiod_Tab_PigmentsCorrelation.Rds"))
PigmentsCorrelation<-PigmentsCorrelation

myft <- flextable(PigmentsCorrelation)
myft <- set_caption(myft, caption = "Linear regression, coefficient of determination (R square), correlation coefficients (R), and p-value used to calculate the pigment content (µg/mL) of studied picocyanobacteria based on absorbance values (Abs) of individual pigment peaks obtained from the whole-cell absorbance spectra.")
myft <- colformat_double(x = myft, big.mark = ",", digits = 3, na_str = "N/A")
myft <- fontsize(myft, size = 12, part = "header")
myft <- fontsize(myft, size = 10, part = "body")
myft <- autofit(myft)
myft

rm(PigmentsCorrelation)
```


```{r echo = FALSE}
Anova_GrowthRate <- readRDS(file = file.path("..", "Output", "TablesRds", "BalticPhotoperiod_Anova_GrowthRate.Rds"))
Anova_GrowthRate<-Anova_GrowthRate
df <- data.frame(Source_of_variation = c("Par_ue", "Photoperiod", "Strain", "Par_ue:Photoperiod", "Par_ue:Strain", "Photoperiod:Strain", "Par_ue:Photoperiod:Strain", "Residuals"))
Anova_GrowthRate<-cbind(df, Anova_GrowthRate) 
Anova_GrowthRate<-Anova_GrowthRate %>% 
  rename(p_value = "Pr(>F)") %>% 
  rename(F_value = "F value")


myft <- flextable(Anova_GrowthRate)
myft <- set_caption(myft, caption = "Three-way factorial ANOVA of chlorophyll specific exponential growth rate, estimated from logistic fits of chlorophyll proxy OD680-OD720 vs. elapsed time, for two PhycoCyanin(PC)-rich cultures (056, 077) and two PhycoErythrin(PE)-rich cultures (048, 127) (Culture Collection of Baltic Algae) of Synechococcus sp., grown at 30, 90, 180, 300, 600, or 900 peak PAR µmol photons m−2s−1; and photoperiods of 8, 12, 16, or 24 h. Df – degrees of freedom; Sum Sq – sum of squares; Mean Sq – mean sum of squares; F_value – Fisher's F-test statistic; p_value - level of significance.")
myft <- colformat_double(x = myft, big.mark = ",", digits = 3, na_str = "N/A")
myft <- set_formatter(myft, F_value = function(x) {formatC(x, format = "e", digits = 3)})
myft <- fontsize(myft, size = 12, part = "header")
myft <- fontsize(myft, size = 10, part = "body")
myft <- autofit(myft)
myft

rm(Anova_GrowthRate, df)
```


```{r echo = FALSE}
GrowthRate_Model_Photoperiod <- readRDS(file = file.path("..", "Output", "TablesRds", "BalticPhotoperiod_Anova_GrowthRate_Model_Photoperiod.Rds"))
GrowthRate_Model_Photoperiod<-GrowthRate_Model_Photoperiod %>% 
  select(-c("Df", "Sum Sq")) %>% 
  rename(p_value = "Pr(>F)") %>% 
  rename(F_value = "F value") %>% 
  relocate(FitComparison, .before = Res.Df) %>% 
  relocate(Strain, .before = FitComparison) 
  

myft <- flextable(GrowthRate_Model_Photoperiod)
myft <- set_caption(myft, caption = "One-way ANOVA of pooled and individual fit data (FitComparison), for two PhycoCyanin(PC)-rich cultures (056, 077) and two PhycoErythrin(PE)-rich cultures (048, 127) (Culture Collection of Baltic Algae) of Synechococcus sp., grown at 30, 90, 180, 300, or 900 peak PAR µmol photons m−2s−1; and photoperiods of 8, 12, or 16 h, with a three parameter model (Harrison and Platt, 1986) for growth at 8, 12, 16, or 24 h. Res.Df - residual degrees of freedom for each model; Res.Sum Sq - residual sum of squares for each model; F_value – Fisher's F-test statistic; p_value - level of significance.")
myft <- colformat_double(x = myft, big.mark = ",", digits = 3, na_str = "N/A")
myft <- set_formatter(myft, F_value = function(x) {formatC(x, format = "e", digits = 3)})
myft <- fontsize(myft, size = 12, part = "header")
myft <- fontsize(myft, size = 10, part = "body")
myft <- autofit(myft)
myft

rm(GrowthRate_Model_Photoperiod)
```

```{r echo = FALSE}
Anova_GrowthRate_Model_Light <- readRDS(file = file.path("..", "Output", "TablesRds", "BalticPhotoperiod_Anova_GrowthRate_Model_Light.Rds"))
Anova_GrowthRate_Model_Light<-Anova_GrowthRate_Model_Light %>% 
  select(-c("Df", "Sum Sq")) %>% 
  rename(p_value = "Pr(>F)") %>% 
  rename(F_value = "F value") %>% 
  relocate(FitComparison, .before = Res.Df) %>% 
  relocate(Strain, .before = FitComparison) 
  

myft <- flextable(Anova_GrowthRate_Model_Light)
myft <- set_caption(myft, caption = "One-way ANOVA of pooled and individual fit data (FitComparison), for two PhycoCyanin(PC)-rich cultures (056, 077) and two PhycoErythrin(PE)-rich cultures (048, 127) (Culture Collection of Baltic Algae) of Synechococcus sp., grown at 30, 90, 180, 300, or 900 peak PAR µmol photons m−2s−1; and photoperiods of 8, 12, or 16 h, with a three parameter model (Harrison and Platt, 1986) for growth at 30, 90, 180, 300, or 600 together with 900 peak PAR µmol photons m−2s−1. Res.Df - residual degrees of freedom for each model; Res.Sum Sq - residual sum of squares for each model; F_value – Fisher's F-test statistic; p_value - level of significance.")
myft <- colformat_double(x = myft, big.mark = ",", digits = 3, na_str = "N/A")
myft <- set_formatter(myft, F_value = function(x) {formatC(x, format = "e", digits = 3)})
myft <- fontsize(myft, size = 12, part = "header")
myft <- fontsize(myft, size = 10, part = "body")
myft <- autofit(myft)
myft

rm(Anova_GrowthRate_Model_Light)
```

```{r echo = FALSE}
Anova_GS <- readRDS(file = file.path("..", "Output", "TablesRds", "BalticPhotoperiod_Anova_GS.Rds"))
Anova_GS<-Anova_GS
df <- data.frame(Source_of_variation = c("PhotonDose_day", "Phase", "Strain", "PhotonDose_day:Phase", "PhotonDose_day:Strain", "Phase:Strain", "PhotonDose_day:Phase:Strain", "Residuals"))
Anova_GS<-cbind(df, Anova_GS) 
Anova_GS<-Anova_GS %>% 
  rename(p_value = "Pr(>F)") %>% 
  rename(F_value = "F value") 


myft <- flextable(Anova_GS)
myft <- set_caption(myft, caption = "Three-way factorial ANOVA of index of diel growth symmetry (AccLen/DecLen), for two PhycoCyanin(PC)-rich cultures (056, 077) and two PhycoErythrin(PE)-rich cultures (048, 127) (Culture Collection of Baltic Algae) of Synechococcus sp., grown at 30, 90, 180, 300, 600, or 900 peak PAR µmol photons m−2s−1; and photoperiods of 8, 12, 16, or 24 h. Df – degrees of freedom; Sum Sq – sum of squares; Mean Sq – mean sum of squares; F_value – Fisher's F-test statistic; p_value - level of significance.")
myft <- colformat_double(x = myft, big.mark = ",", digits = 3, na_str = "N/A")
myft <- set_formatter(myft, F_value = function(x) {formatC(x, format = "e", digits = 3)})
myft <- fontsize(myft, size = 12, part = "header")
myft <- fontsize(myft, size = 10, part = "body")
myft <- autofit(myft)
myft

rm(Anova_GS, df)
```

```{r echo = FALSE}
Anova_GS_Model <- readRDS(file = file.path("..", "Output", "TablesRds", "BalticPhotoperiod_Anova_GS_Model.Rds"))
Anova_GS_Model<-Anova_GS_Model %>% 
  select(-c("Df", "Sum Sq")) %>% 
  rename(p_value = "Pr(>F)") %>% 
  rename(F_value = "F value") %>% 
  relocate(FitComparison, .before = Res.Df) 
  

myft <- flextable(Anova_GS_Model)
myft <- set_caption(myft, caption = "One-way ANOVA of single phase exponential decay fit of pooled data (FitComparison), for two PhycoCyanin(PC)-rich cultures (056, 077) and two PhycoErythrin(PE)-rich cultures (048, 127) (Culture Collection of Baltic Algae) of Synechococcus sp., grown at 30, 90, 180, 300, or 900 peak PAR µmol photons m−2s−1; and photoperiods of 8, 12, or 16 h. Res.Df - residual degrees of freedom for each model; Res.Sum Sq - residual sum of squares for each model; F_value – Fisher's F-test statistic; p_value - level of significance.")
myft <- colformat_double(x = myft, big.mark = ",", digits = 3, na_str = "N/A")
myft <- set_formatter(myft, F_value = function(x) {formatC(x, format = "e", digits = 3)})
myft <- fontsize(myft, size = 12, part = "header")
myft <- fontsize(myft, size = 10, part = "body")
myft <- autofit(myft)
myft

rm(Anova_GS_Model)
```




